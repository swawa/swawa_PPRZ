/* This file has been generated from /home/excelobs/paparazzi/conf/airframes/KMUAV_XBee_Airspeed_IMU2.xml */
/* Please DO NOT EDIT */

#ifndef AIRFRAME_H
#define AIRFRAME_H 

#define AIRFRAME_NAME "KMUAV_XB_AS_IMU"
#define AC_ID 10
#define MD5SUM ((uint8_t*)"\367\300\267\017\251\253\277\072\113\074\065\150\004\262\202\241")

#define SERVOS_NB 4

#define SERVO_MOTOR 0
#define SERVO_MOTOR_NEUTRAL 1290
#define SERVO_MOTOR_TRAVEL_UP 0.0541666666667
#define SERVO_MOTOR_TRAVEL_DOWN 0
#define SERVO_MOTOR_MAX 1810
#define SERVO_MOTOR_MIN 1290

#define SERVO_AILEVON_LEFT 1
#define SERVO_AILEVON_LEFT_NEUTRAL 1510
#define SERVO_AILEVON_LEFT_TRAVEL_UP -0.053125
#define SERVO_AILEVON_LEFT_TRAVEL_DOWN -0.0510416666667
#define SERVO_AILEVON_LEFT_MAX 2000
#define SERVO_AILEVON_LEFT_MIN 1000

#define SERVO_AILEVON_RIGHT 3
#define SERVO_AILEVON_RIGHT_NEUTRAL 1535
#define SERVO_AILEVON_RIGHT_TRAVEL_UP 0.0484375
#define SERVO_AILEVON_RIGHT_TRAVEL_DOWN 0.0557291666667
#define SERVO_AILEVON_RIGHT_MAX 2000
#define SERVO_AILEVON_RIGHT_MIN 1000

#define SERVO_ELEVATOR 1
#define SERVO_ELEVATOR_NEUTRAL 1510
#define SERVO_ELEVATOR_TRAVEL_UP -0.053125
#define SERVO_ELEVATOR_TRAVEL_DOWN -0.0510416666667
#define SERVO_ELEVATOR_MAX 2000
#define SERVO_ELEVATOR_MIN 1000

#define SERVO_RUDDER 3
#define SERVO_RUDDER_NEUTRAL 1535
#define SERVO_RUDDER_TRAVEL_UP 0.0484375
#define SERVO_RUDDER_TRAVEL_DOWN 0.0557291666667
#define SERVO_RUDDER_MAX 2000
#define SERVO_RUDDER_MIN 1000


#define COMMAND_THROTTLE 0
#define COMMAND_ROLL 1
#define COMMAND_PITCH 2
#define COMMANDS_NB 3
#define COMMANDS_FAILSAFE {0,0,0}


#define SetCommandsFromRC(_commands_array, _rc_array) { \
  _commands_array[COMMAND_THROTTLE] = _rc_array[RADIO_THROTTLE];\
  _commands_array[COMMAND_ROLL] = _rc_array[RADIO_ROLL];\
  _commands_array[COMMAND_PITCH] = _rc_array[RADIO_PITCH];\
}

#define SECTION_MIXER 1
#define AILEVON_AILERON_RATE 0.75
#define AILEVON_ELEVATOR_RATE 0.75

#define SECTION_INS 1
#define INS_ROLL_NEUTRAL_DEFAULT 0
#define INS_PITCH_NEUTRAL_DEFAULT 0

#define SetActuatorsFromCommands(values) { \
  uint32_t servo_value;\
  float command_value;\
  command_value = values[COMMAND_THROTTLE];\
  command_value *= command_value>0 ? SERVO_MOTOR_TRAVEL_UP : SERVO_MOTOR_TRAVEL_DOWN;\
  servo_value = SERVO_MOTOR_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_MOTOR] = ChopServo(servo_value, SERVO_MOTOR_MIN, SERVO_MOTOR_MAX);\
\
  Actuator(SERVO_MOTOR) = SERVOS_TICS_OF_USEC(actuators[SERVO_MOTOR]);\
\
  command_value = values[COMMAND_ROLL];\
  command_value *= command_value>0 ? SERVO_AILEVON_LEFT_TRAVEL_UP : SERVO_AILEVON_LEFT_TRAVEL_DOWN;\
  servo_value = SERVO_AILEVON_LEFT_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_AILEVON_LEFT] = ChopServo(servo_value, SERVO_AILEVON_LEFT_MIN, SERVO_AILEVON_LEFT_MAX);\
\
  Actuator(SERVO_AILEVON_LEFT) = SERVOS_TICS_OF_USEC(actuators[SERVO_AILEVON_LEFT]);\
\
  command_value = values[COMMAND_ROLL];\
  command_value *= command_value>0 ? SERVO_AILEVON_RIGHT_TRAVEL_UP : SERVO_AILEVON_RIGHT_TRAVEL_DOWN;\
  servo_value = SERVO_AILEVON_RIGHT_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_AILEVON_RIGHT] = ChopServo(servo_value, SERVO_AILEVON_RIGHT_MIN, SERVO_AILEVON_RIGHT_MAX);\
\
  Actuator(SERVO_AILEVON_RIGHT) = SERVOS_TICS_OF_USEC(actuators[SERVO_AILEVON_RIGHT]);\
\
  command_value = values[COMMAND_PITCH];\
  command_value *= command_value>0 ? SERVO_ELEVATOR_TRAVEL_UP : SERVO_ELEVATOR_TRAVEL_DOWN;\
  servo_value = SERVO_ELEVATOR_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_ELEVATOR] = ChopServo(servo_value, SERVO_ELEVATOR_MIN, SERVO_ELEVATOR_MAX);\
\
  Actuator(SERVO_ELEVATOR) = SERVOS_TICS_OF_USEC(actuators[SERVO_ELEVATOR]);\
\
  command_value = values[COMMAND_PITCH];\
  command_value *= command_value>0 ? SERVO_RUDDER_TRAVEL_UP : SERVO_RUDDER_TRAVEL_DOWN;\
  servo_value = SERVO_RUDDER_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_RUDDER] = ChopServo(servo_value, SERVO_RUDDER_MIN, SERVO_RUDDER_MAX);\
\
  Actuator(SERVO_RUDDER) = SERVOS_TICS_OF_USEC(actuators[SERVO_RUDDER]);\
\
  ActuatorsCommit();\
}

#define AllActuatorsInit() { \
  ActuatorsInit();\
}

#define SECTION_AUTO1 1
#define AUTO1_MAX_ROLL 0.7
#define AUTO1_MAX_PITCH 0.6

#define SECTION_BAT 1
#define MILLIAMP_AT_FULL_THROTTLE 2000
#define CATASTROPHIC_BAT_LEVEL 11.0
#define CRITIC_BAT_LEVEL 11.1
#define LOW_BAT_LEVEL 11.2
#define MAX_BAT_LEVEL 11.4

#define SECTION_MISC 1
#define NOMINAL_AIRSPEED 13.
#define CARROT 5.
#define KILL_MODE_DISTANCE (1.5*MAX_DIST_FROM_HOME)
#define CONTROL_RATE 60
#define ALT_KALMAN_ENABLED TRUE
#define DEFAULT_CIRCLE_RADIUS 120.
#define GLIDE_AIRSPEED 10
#define GLIDE_VSPEED 3.
#define GLIDE_PITCH 45

#define SECTION_VERTICAL CONTROL 1
#define V_CTL_POWER_CTL_BAT_NOMINAL 11.1
#define V_CTL_ALTITUDE_PGAIN -0.03
#define V_CTL_ALTITUDE_MAX_CLIMB 4.
#define V_CTL_AUTO_THROTTLE_NOMINAL_CRUISE_THROTTLE 0.32
#define V_CTL_AUTO_THROTTLE_MIN_CRUISE_THROTTLE 0.25
#define V_CTL_AUTO_THROTTLE_MAX_CRUISE_THROTTLE 0.65
#define V_CTL_AUTO_THROTTLE_LOITER_TRIM 1500
#define V_CTL_AUTO_THROTTLE_DASH_TRIM -4000
#define V_CTL_AUTO_THROTTLE_CLIMB_THROTTLE_INCREMENT 0.15
#define V_CTL_AUTO_THROTTLE_PGAIN -0.01
#define V_CTL_AUTO_THROTTLE_IGAIN 0.1
#define V_CTL_AUTO_THROTTLE_DGAIN 0.2
#define V_CTL_AUTO_THROTTLE_PITCH_OF_VZ_PGAIN 0.05
#define V_CTL_AUTO_AIRSPEED_SETPOINT 13.0
#define V_CTL_AUTO_AIRSPEED_PGAIN 0.060
#define V_CTL_AUTO_AIRSPEED_IGAIN 0.050
#define V_CTL_AUTO_GROUNDSPEED_SETPOINT 7.0
#define V_CTL_AUTO_GROUNDSPEED_PGAIN 0.75
#define V_CTL_AUTO_GROUNDSPEED_IGAIN 0.25
#define V_CTL_AUTO_PITCH_PGAIN -0.125
#define V_CTL_AUTO_PITCH_IGAIN 0.025
#define V_CTL_AUTO_PITCH_MAX_PITCH 0.25
#define V_CTL_AUTO_PITCH_MIN_PITCH -0.25
#define V_CTL_THROTTLE_SLEW 1.0

#define SECTION_HORIZONTAL CONTROL 1
#define H_CTL_COURSE_PGAIN -1.4
#define H_CTL_ROLL_MAX_SETPOINT 0.6
#define H_CTL_PITCH_MAX_SETPOINT 0.5
#define H_CTL_PITCH_MIN_SETPOINT -0.5
#define H_CTL_PITCH_PGAIN -12000.
#define H_CTL_AILERON_OF_THROTTLE 0.0
#define H_CTL_PITCH_DGAIN 1.5
#define H_CTL_ELEVATOR_OF_ROLL 2400
#define H_CTL_ROLL_ATTITUDE_GAIN -7500
#define H_CTL_ROLL_SLEW 0.1
#define H_CTL_ROLL_RATE_GAIN -1500

#define SECTION_AGGRESSIVE 1
#define AGR_BLEND_START 20
#define AGR_BLEND_END 10
#define AGR_CLIMB_THROTTLE 0.70
#define AGR_CLIMB_PITCH 0.3
#define AGR_DESCENT_THROTTLE 0.1
#define AGR_DESCENT_PITCH -0.25
#define AGR_CLIMB_NAV_RATIO 0.8
#define AGR_DESCENT_NAV_RATIO 1.0

#define SECTION_FAILSAFE 1
#define FAILSAFE_DELAY_WITHOUT_GPS 2
#define FAILSAFE_DEFAULT_THROTTLE 0.3
#define FAILSAFE_DEFAULT_ROLL 0.3
#define FAILSAFE_DEFAULT_PITCH 0.5
#define FAILSAFE_HOME_RADIUS 100

#define SECTION_DATALINK 1
#define DATALINK_DEVICE_TYPE PPRZ
#define DATALINK_DEVICE_ADDRESS 22

#define SECTION_NAV 1
#define NAV_PITCH 0.
#define NAV_GLIDE_PITCH_TRIM 0


#endif // AIRFRAME_H
